<div class="container mx-auto p-4 md:p-8">
  <header class="text-center mb-8 relative">
    <h1 class="text-4xl md:text-5xl font-bold text-[#6A5A4F] mb-2">Soil & Crop Nutrition Guide</h1>
    <p class="text-lg text-gray-600">An Interactive Dashboard for South Indian Agriculture</p>
    
    @if (showInstallButton()) {
      <div class="mt-4 md:absolute md:top-0 md:right-0">
        <button (click)="installPwa()" class="bg-[#A47E3B] text-white font-bold py-2 px-6 rounded-full shadow-lg hover:bg-[#8e6b34] transition-colors duration-300 flex items-center justify-center gap-2 mx-auto">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
          </svg>
          Install App
        </button>
      </div>
    }
  </header>

  <nav class="flex flex-wrap justify-center bg-[#F1EADF] rounded-full p-2 mb-10 max-w-5xl mx-auto shadow-sm">
    @for (section of sections; track section.id) {
      <button 
        (click)="showSection(section.id)"
        [class]="'flex-grow md:flex-initial nav-button text-center py-2 px-3 md:px-4 rounded-full font-semibold transition-all duration-300 ' + (activeSection() === section.id ? 'active bg-[#A47E3B] text-white shadow-md' : 'hover:bg-[#e6dcd0]')">
        {{ section.icon }} {{ section.label }}
      </button>
    }
  </nav>

  <main>
    @switch (activeSection()) {
      @case ('npk') {
        <app-npk-readings></app-npk-readings>
      }
      @case ('tank') {
        <app-tank-monitor></app-tank-monitor>
      }
      @case ('motor') {
        <app-motor-control></app-motor-control>
      }
      @case ('plant') {
        <app-plant-analyser (generateFertilizer)="handleGenerateFertilizer($event)"></app-plant-analyser>
      }
      @case ('generator') {
        <app-fertilizer-generator 
          [initialDeficiencies]="generatorInitialDeficiencies()"
          [source]="generatorSource()"
          (resetToSensor)="handleResetGenerator()">
        </app-fertilizer-generator>
      }
      @case ('soils') {
        <app-soil-explorer></app-soil-explorer>
      }
      @case ('crops') {
        <app-crop-guide (generateFertilizerForCrop)="handleGenerateFertilizerForCrop($event)"></app-crop-guide>
      }
      @case ('references') {
        <app-references></app-references>
      }
    }
  </main>
</div>